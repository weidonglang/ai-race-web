<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>训练看板 · AI Race</title>
  <link rel="stylesheet" href="/src/style.css"/>

  <!-- 这里加一点局部样式，只负责 Dashboard 布局和小组件 -->
  <style>
    body { background: radial-gradient(circle at 20% 0%, rgba(96, 165, 250, 0.08), transparent 40%), #0b0e14; }

    .dash-header {
      position: sticky;
      top: 0;
      z-index: 101;
      background: rgba(10, 15, 23, 0.95);
      border-bottom: 1px solid #1c2533;
      backdrop-filter: blur(10px);
      margin-bottom: 8px;
    }
    .dash-header-inner {
      max-width: 1180px;
      margin: 0 auto;
      padding: 10px 20px;
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 14px;
    }
    .dash-header .nav { justify-content: center; }
    .dash-header .nav > li { padding-bottom: 6px; }
    .dash-header .nav > li > a { padding: 8px 12px; }

    .back-btn {
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #2c3342;
      background: #1a2130;
      color: #dce5f0;
      cursor: pointer;
      font-size: 12px;
      white-space: nowrap;
      transition: background 0.15s ease, border-color 0.15s ease;
    }
    .back-btn:hover { background: #233049; border-color: #3b82f6; }

    .dash-main { max-width: 1180px; margin: 12px auto 40px; }
    .dash-main h1 { margin-bottom: 10px; font-size: 26px; }
    .dash-lead { color:#9db0c6; line-height: 1.7; margin-top: 0; font-size: 14px; }

    main.container section {
      margin-top: 22px;
      padding: 18px 16px 22px;
      border-radius: 14px;
      border: 1px solid #1c2533;
      background: #101621;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.35);
    }

    main.container section h2 {
      margin: 0 0 6px 0;
      font-size: 19px;
    }

    main.container section p.desc {
      margin: 0 0 10px 0;
      color: #9db0c6;
      font-size: 14px;
      line-height: 1.8;
    }

    .chart-row {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      align-items: flex-start;
    }

    .chart-row canvas {
      flex: 1 1 320px;
      max-width: 520px;
      min-width: 280px;
      background: #0b0f18;
      border-radius: 12px;
      padding: 12px;
      box-shadow: inset 0 0 0 1px #1f2937;
    }

    .stats-box {
      flex: 1;
      min-width: 220px;
      font-size: 14px;
      color: #cbd5e1;
      line-height: 1.7;
    }

    .stats-box ul {
      margin: 6px 0 0 18px;
      padding: 0;
    }

    .stats-box li { margin: 2px 0; }

    .stats-box code {
      color: #93c5fd;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <!-- 顶部导航，与其他页面保持一致 -->
  <header class="dash-header">
    <div class="dash-header-inner">
      <a href="index.html" class="brand">
        <img src="/log.svg" alt="AI Race logo" class="brand-logo">
        <span class="brand-text">AI Race</span>
      </a>
      <ul class="nav">
        <li><a href="editor.html">编辑器</a></li>
        <li><a href="lab.html">AI 实验室</a></li>
        <li><a href="dashboard.html">训练看板</a></li>
        <li><a href="arena.html">对抗 Arena</a></li>
        <li>
          <a href="#">更多 ▾</a>
          <div class="dropdown">
            <a href="help.html">帮助</a>
            <a href="about.html">关于</a>
          </div>
        </li>
      </ul>
      <!-- 返回按钮：如果有浏览历史就后退，否则回到首页 -->
      <button class="back-btn"
              onclick="if (history.length > 1) history.back(); else location.href='index.html'">
        ← 返回
      </button>
    </div>
  </header>

  <main class="container dash-main">
    <h1>训练看板 · 双智能体 RL 对比</h1>
    <p class="dash-lead">
      本页从浏览器 <code>localStorage('arena_rl_dual_stats')</code> 中读取 <b>双智能体 RL 训练过程</b> 的快照，
      对比两个智能体在同一 3D 迷宫环境下：谁更快学会到达终点、谁走出的路径更接近理论最短。
    </p>

    <!-- 文本统计总览：平均成功率 / 路径效率 / 首次 100% 回合数 / 领先者 -->
    <section>
      <h2>训练总览 · 谁学得更快、走得更短？</h2>
      <p class="desc">
        这里汇总训练期间的平均成功率、最近窗口的路径效率（平均步数 / 最短步数），
        以及首次达到“接近 100% 成功率”的回合数，用于整体判断 A / B 两个智能体的表现。
      </p>
      <div class="stats-box" id="statsRlDual">
        <!-- dashboard.js 会在这里填充统计文本 -->
      </div>
    </section>

    <!-- 三张折线图：成功率 / 步数 / epsilon -->
    <section>
      <h2>训练曲线 · 成功率 / 步数 / 探索率</h2>
      <p class="desc">
        三张曲线分别展示：
        (1) A/B 成功率随训练进度的变化；
        (2) 平均步数相对于“理论最短步数”的收敛情况；
        (3) epsilon（探索率）随训练过程的衰减。
      </p>

      <div class="chart-row">
        <!-- 成功率曲线 -->
        <canvas id="chartRlSucc"  height="200"></canvas>
        <!-- 步数 vs 最短步数 -->
        <canvas id="chartRlSteps" height="200"></canvas>
      </div>

      <div class="chart-row" style="margin-top:16px">
        <!-- epsilon 衰减 -->
        <canvas id="chartRlEps"   height="200"></canvas>
      </div>
    </section>
  </main>

  <footer class="footer">© 2025 AI Race Demo</footer>

  <!-- Chart.js CDN，用于绘制统计曲线 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // 提前放大图表字体，便于阅读
    if (window.Chart && Chart.defaults && Chart.defaults.font) {
      Chart.defaults.font.size = 13;
      Chart.defaults.font.family = 'system-ui, -apple-system, \"Segoe UI\", sans-serif';
      Chart.defaults.color = '#e5e7eb';\n      Chart.defaults.scale = Chart.defaults.scale || {};\n      Chart.defaults.scale.ticks = {\n        color: '#e5e7eb',\n        padding: 10,\n        font: { size: 13, weight: '600' }\n      };\n      Chart.defaults.plugins = Chart.defaults.plugins || {};\n      Chart.defaults.plugins.legend = Chart.defaults.plugins.legend || {};\n      Chart.defaults.plugins.legend.labels = {\n        color: '#e5e7eb',\n        padding: 18,\n        font: { size: 13 }\n      };\n    }
  </script>
  <!-- 本页主逻辑：从 localStorage 读取数据，绘制图表并填充文字说明 -->
  <script type="module" src="/src/dashboard.js"></script>
</body>
</html>


