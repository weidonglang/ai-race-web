<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>案例三：困难迷宫与失败分析 · AI Race</title>
  <link rel="stylesheet" href="/src/style.css"/>

  <style>
    main.doc-page{
      max-width: 960px;
      margin:24px auto 40px;
      padding:0 16px 40px;
    }

    .doc-hero,
    .doc-section{
      position:relative;
      margin-top:24px;
      padding:20px 20px 22px;
      border-radius:18px;
      border:1px solid #1c2533;
      background:radial-gradient(circle at top left,
                  rgba(248,113,113,0.20), rgba(15,23,42,1) 55%);
      overflow:hidden;
      opacity:0;
      transform:translateY(22px);
      transition:
        opacity .65s ease-out,
        transform .65s ease-out,
        box-shadow .65s ease-out,
        border-color .65s ease-out,
        background 1s ease-out;
    }
    .doc-hero::before,
    .doc-section::before{
      content:"";
      position:absolute;
      inset:-1px;
      background:linear-gradient(120deg,
                  rgba(248,113,113,0.0),
                  rgba(248,113,113,0.45),
                  rgba(59,130,246,0.0));
      transform:translateX(-45%);
      opacity:0;
      transition:
        transform 1.1s ease-out,
        opacity 1.1s ease-out;
      pointer-events:none;
    }
    .doc-visible{
      opacity:1;
      transform:none;
      box-shadow:0 26px 70px rgba(0,0,0,.55);
      border-color:rgba(248,113,113,.9);
      background:radial-gradient(circle at top left,
                  rgba(248,113,113,0.26), rgba(15,23,42,1) 60%);
    }
    .doc-visible::before{
      transform:translateX(0);
      opacity:1;
    }

    .doc-hero h1{
      margin:0 0 8px;
      font-size:26px;
    }
    .doc-hero p{
      margin:4px 0 0;
      color:var(--muted);
      font-size:13px;
      max-width:540px;
    }

    .doc-section h2{
      margin:0 0 8px;
      font-size:20px;
    }
    .doc-section h3{
      margin:14px 0 4px;
      font-size:15px;
    }
    .doc-section p{
      margin:4px 0 8px;
      font-size:14px;
      line-height:1.65;
      color:var(--muted);
    }
    .doc-section ul{
      margin:6px 0 8px 1.1em;
      padding:0;
      font-size:14px;
      color:var(--muted);
    }
    .doc-section li{margin:2px 0;}
    code{
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12px;
      background:#020617;
      padding:1px 4px;
      border-radius:4px;
      border:1px solid #1f2937;
    }
  </style>

  <!-- 统一案例/FAQ 组的新外观（与帮助组截然不同） -->
  <style>
    :root{
      --case-accent: #38bdf8;
      --case-accent-2: #f472b6;
      --case-border: #1f2737;
      --case-surface: #0b1220;
      --case-muted: #b7c4da;
    }
    main.doc-page{
      max-width: 980px;
      margin:28px auto 44px;
      padding:0 18px 44px;
    }
    .doc-hero,
    .doc-section{
      position:relative;
      margin-top:26px;
      padding:22px 22px 24px;
      border-radius:14px;
      border:1px solid var(--case-border);
      border-left:3px solid var(--case-accent);
      background:
        linear-gradient(145deg, rgba(56,189,248,0.12), rgba(244,114,182,0.08)),
        linear-gradient(0deg, rgba(255,255,255,0.02), rgba(255,255,255,0)),
        var(--case-surface);
      box-shadow:0 18px 44px rgba(0,0,0,0.55);
      overflow:hidden;
      opacity:0;
      transform:translateY(18px) scale(0.99);
      transition:
        opacity .5s ease-out,
        transform .5s ease-out,
        box-shadow .5s ease-out,
        border-color .5s ease-out,
        background .8s ease-out;
    }
    .doc-hero::before,
    .doc-section::before{
      content:"";
      position:absolute;
      top:0; left:0; right:0;
      height:3px;
      background:linear-gradient(90deg, var(--case-accent), var(--case-accent-2));
      opacity:0.9;
    }
    .doc-hero::after,
    .doc-section::after{
      content:"";
      position:absolute;
      inset:6px;
      border-radius:12px;
      background:radial-gradient(circle at 14% 0%, rgba(56,189,248,0.10), transparent 55%);
      opacity:0;
      transition:opacity .8s ease-out;
      pointer-events:none;
    }
    .doc-visible{
      opacity:1;
      transform:translateY(0) scale(1);
      border-color:color-mix(in srgb, var(--case-accent) 70%, var(--case-border) 30%);
      box-shadow:0 24px 60px rgba(0,0,0,0.6);
    }
    .doc-visible::after{
      opacity:1;
    }
    .doc-hero h1{
      margin:0 0 8px;
      font-size:26px;
      letter-spacing:.01em;
    }
    .doc-hero p{
      margin:4px 0 0;
      color:var(--case-muted);
      font-size:13px;
      max-width:560px;
    }
    .doc-section h2{
      margin:0 0 8px;
      font-size:20px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .doc-section h3{
      margin:14px 0 6px;
      font-size:15px;
    }
    .doc-section p{
      margin:4px 0 8px;
      font-size:14px;
      line-height:1.65;
      color:var(--case-muted);
    }
    .doc-section ul{
      margin:6px 0 8px 1.1em;
      padding:0;
      font-size:14px;
      color:var(--case-muted);
    }
    .doc-section li{ margin:2px 0; }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:3px 10px;
      border-radius:999px;
      background:rgba(56,189,248,0.14);
      border:1px solid rgba(56,189,248,0.4);
      color:#e0f2fe;
      font-size:12px;
      font-weight:600;
    }
    .case-topbar{
      max-width: 980px;
      margin:16px auto 0;
      padding:0 18px;
      display:flex;
      justify-content:flex-start;
    }
    .case-back{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 14px;
      border-radius:12px;
      border:1px solid var(--case-border);
      background:linear-gradient(120deg, rgba(56,189,248,0.14), rgba(244,114,182,0.12));
      color:#e5e7eb;
      cursor:pointer;
      font-size:13px;
      letter-spacing:0.1px;
      box-shadow:0 10px 28px rgba(0,0,0,0.35);
      transition:transform .15s ease, border-color .2s ease, background .2s ease;
    }
    .case-back:hover{
      transform:translateY(-1px);
      border-color:var(--case-accent);
      background:linear-gradient(120deg, rgba(56,189,248,0.22), rgba(244,114,182,0.18));
    }
    .case-back:active{ transform:translateY(0); }
  </style>
</head>
<body>
<header>
  <a href="index.html" class="brand">
    <img src="/log.svg" alt="AI Race logo" class="brand-logo">
    <span class="brand-text">AI Race</span>
  </a>
  <ul class="nav">
    <li><a href="editor.html">编辑器</a></li>
    <li><a href="lab.html">AI 实验室</a></li>
    <li><a href="dashboard.html">训练看板</a></li>
    <li><a href="arena.html">对抗 Arena</a></li>
    <li>
      <a href="#">更多 ▾</a>
      <div class="dropdown">
        <a href="help.html">帮助/原理</a>
        <a href="about.html">关于</a>
      </div>
    </li>
  </ul>
</header>

<div class="case-topbar">
  <button class="case-back" type="button"
    onclick="if (history.length > 1) { history.back(); } else { window.location.href='index.html'; }">
    ← 返回
  </button>
</div>

  <main class="doc-page">
  <section class="doc-hero">
    <h1>案例三：困难迷宫与失败分析</h1>
    <p>
      在高复杂度迷宫中，Q-learning 训练往往难以完全收敛：成功率长期停在低位、
      步数大幅波动。本案例给出如何观察这些「失败现象」，并从参数和建模角度分析原因。
    </p>
  </section>

  <section class="doc-section">
    <h2>① 困难迷宫场景设定</h2>
    <p>在 Arena 中选择类似 <code>maze_hard_*.json</code> 的迷宫：</p>
    <ul>
      <li>尺寸较大（例如 24×24 甚至更大）。</li>
      <li>存在大量环路、长走廊和死胡同。</li>
      <li>最短路径很长，且中途存在多次「必须回头」的选择点。</li>
    </ul>
    <p>
      对 Q-learning 来说，这类任务意味着更大的状态空间、更长的时间差分依赖，
      如果参数不合适，很容易表现为「学不动」。
    </p>
  </section>

  <section class="doc-section">
    <h2>② 典型不稳定 / 失败现象</h2>
    <p>在 Dashboard 中，你可能会看到一些典型的「训练不理想」曲线：</p>
    <ul>
      <li>成功率长期徘徊在 10%–40%，很难进一步上升。</li>
      <li>平均步数 / 最短步数远大于 2，并且波动很大。</li>
      <li>ε 已经衰减到 <code>epsilonMin</code>，但策略仍然很差。</li>
      <li>有时成功率突然掉回很低，说明策略被新的 Q 更新「破坏」。</li>
    </ul>
    <p>
      对应到 Arena 3D 视图，可以看到智能体经常在某些环路里反复徘徊，
      或频繁撞上陷阱、走进死胡同。
    </p>
  </section>

  <section class="doc-section">
    <h2>③ 可能的原因分析</h2>
    <p>常见原因可以从以下几个维度分析：</p>

    <h3>1. 参数设置问题</h3>
    <ul>
      <li>学习率 α 过大：在「长链条」奖励传递过程中，Q 值更新过于剧烈，导致震荡。</li>
      <li>γ 过小：对远期奖励折扣过度，智能体更倾向于短期安全，而不是走长路径。</li>
      <li>ε 衰减过快：还没充分探索完迷宫，ε 就降到了最小值。</li>
      <li>单局最大步数过小：很多局在「还差一点」时被强行截断，负反馈过多。</li>
    </ul>

    <h3>2. 奖励设计不合理</h3>
    <ul>
      <li>时间惩罚过大：智能体倾向于早早放弃探索，导致成功率上不去。</li>
      <li>
        未对「接近终点」等中间阶段进行奖励 shaping，
        导致「一路走到底才有奖励」，信号太稀疏。
      </li>
      <li>对撞墙 / 死胡同的惩罚不足，智能体频繁重复走入坏区域。</li>
    </ul>

    <h3>3. 状态表示与离散方式的限制</h3>
    <p>
      目前项目中的状态一般是「离散格子坐标」，没有包含更多历史信息。
      在存在大量环路的迷宫中，仅靠「当前格子」做决策，
      很难区分「第一次来」和「已经在此绕圈很久」。
    </p>
  </section>

  <section class="doc-section">
    <h2>④ 调参与改进建议</h2>
    <p>如果在困难迷宫中训练效果不佳，可以尝试按下面顺序调整：</p>
    <ul>
      <li>适当增大 <code>maxSteps</code>，保证至少有机会走完一条完整路径。</li>
      <li>稍微减小时间惩罚，让智能体敢于多尝试几种路线。</li>
      <li>增大 γ（例如 0.99），强化远期到达终点的收益。</li>
      <li>放慢 ε 的衰减速度，让探索阶段更长。</li>
      <li>在奖励中加入「接近终点」或「走过新格子」的微小正反馈。</li>
    </ul>
    <p>
      更进一步，可以考虑在状态中加入简单的「记忆」（例如最近 N 步的方向），
      或在奖励中惩罚重复走回同一格子太多次，但这些属于本项目之外的扩展方向。
    </p>
  </section>

  <section class="doc-section">
    <h2>⑤ 把失败也写进报告</h2>
    <p>
      困难迷宫的实验即使「没有完全收敛」，也非常适合写进报告，
      说明当前方法的局限性和未来的改进方向：
    </p>
    <ul>
      <li>用一张曲线图展示「始终无法突破的成功率上限」。</li>
      <li>结合参数对比，说明简单调参无法完全解决问题。</li>
      <li>提出可能的改进思路：改进奖励、改用 Deep Q Network、加入记忆等。</li>
    </ul>
    <p>这样一来，整个项目从简单 → 中等 → 困难迷宫，就形成了一个完整的研究故事线。</p>
  </section>
</main>

<footer class="footer">© 2025 AI Race Demo</footer>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const els = document.querySelectorAll('.doc-hero, .doc-section')
    const io = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          e.target.classList.add('doc-visible')
          io.unobserve(e.target)
        }
      })
    }, { threshold: 0.18 })
    els.forEach(el => io.observe(el))
  })
</script>
</body>
</html>



